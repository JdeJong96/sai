/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 38615 instead
  warnings.warn(
Traceback (most recent call last):
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/file_manager.py", line 211, in _acquire_with_cache_info
    file = self._cache[self._key]
           ~~~~~~~~~~~^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/lru_cache.py", line 56, in __getitem__
    value = self._cache[key]
            ~~~~~~~~~~~^^^^^
KeyError: [<class 'netCDF4._netCDF4.Dataset'>, ('/gpfs/home2/jasperdj/sai-git/sai/jobs/temperature/nwo2021025/archive/lres_b.e10.B2000_CAM5.f09_g16.feedforward_2050.001/atm/hist/lres_b.e10.B2000_CAM5.f09_g16.feedforward_2050.001.cam2.h0.????-??.nc',), 'r', (('clobber', True), ('diskless', False), ('format', 'NETCDF4'), ('persist', False)), '86d766ac-ff6b-4978-8997-eeaab8f26cb6']

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/gpfs/home2/jasperdj/sai-git/sai/jobs/temperature/temperaturegradients.py", line 66, in <module>
    main()
  File "/gpfs/home2/jasperdj/sai-git/sai/jobs/temperature/temperaturegradients.py", line 16, in main
    ds = xr.open_mfdataset(args.infiles, data_vars="minimal", coords="minimal", 
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/api.py", line 1056, in open_mfdataset
    datasets = [open_(p, **open_kwargs) for p in paths]
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/api.py", line 573, in open_dataset
    backend_ds = backend.open_dataset(
                 ^^^^^^^^^^^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/netCDF4_.py", line 646, in open_dataset
    store = NetCDF4DataStore.open(
            ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/netCDF4_.py", line 409, in open
    return cls(manager, group=group, mode=mode, lock=lock, autoclose=autoclose)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/netCDF4_.py", line 356, in __init__
    self.format = self.ds.data_model
                  ^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/netCDF4_.py", line 418, in ds
    return self._acquire()
           ^^^^^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/netCDF4_.py", line 412, in _acquire
    with self._manager.acquire_context(needs_lock) as root:
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/contextlib.py", line 137, in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/file_manager.py", line 199, in acquire_context
    file, cached = self._acquire_with_cache_info(needs_lock)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jasperdj/miniconda3/envs/geo/lib/python3.12/site-packages/xarray/backends/file_manager.py", line 217, in _acquire_with_cache_info
    file = self._opener(*self._args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "src/netCDF4/_netCDF4.pyx", line 2469, in netCDF4._netCDF4.Dataset.__init__
  File "src/netCDF4/_netCDF4.pyx", line 2028, in netCDF4._netCDF4._ensure_nc_success
FileNotFoundError: [Errno 2] No such file or directory: '/gpfs/home2/jasperdj/sai-git/sai/jobs/temperature/nwo2021025/archive/lres_b.e10.B2000_CAM5.f09_g16.feedforward_2050.001/atm/hist/lres_b.e10.B2000_CAM5.f09_g16.feedforward_2050.001.cam2.h0.????-??.nc'
